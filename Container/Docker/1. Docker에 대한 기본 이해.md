# Docker에 대한 기본 이해

## 도커의 등장 배경

### 도커 등장 이전의 상황

우선 도커의 등장 배경을 이해하기 위해서는 도커 등장 이전의 상황에 대해서 이해할 필요가 있다.

#### 마이크로 서비스의 등장

서버는 일반적으로 24시간 동안 구동되는 것을 필요로 하며, 특정 목적으로 사용되는 프로그램들이 많다. 또한 다양한 리눅스 패키지와 업데이트 등으로 인해 프로그램 설정 등이 수시로 달라지기도 하며, 서버 이전 시 이전할 서버에 맞춰서 재설정도 필요했다.

초기 서버는 모놀리틱 구조로, 하나의 서버에 모든 기능을 넣는 방식이었다. 그러나 서비스가 방대해지면서 하나의 서버에 모아놓게 되면 특정 기능의 문제가 전체 시스템의 장애로 이어지는 결과를 초래했고, 이는 마이크로 서비스의 등장 배경이 되었다. 방금 같은 문제를 해결하기 위해 여러 서버에 각 기능을 분산해놓은 후, Rest API 등을 이용해 통신하여 전체 서비스를 운영하는 것이다.

#### DevOps의 등장

기존에는 개발팀과 운영팀, 두 조직으로 나뉘어 개발과 운영을 각각 맡아 처리하였었다. 그러나 개발자는 지속저긍로 새로운 것을 도입하고 싶어 하지만, 운영팀은 기본적으로 안정성을 우선으로 여기기 때문에 서로 목적도 다른데다 별개의 팀으로 운영되면서 발생하는 의사소통의 비효율 등의 문제로 인해 효율적으로 작업과 운영을 할 수 있도록 하기 위해 만들어진 개념이 DevOps이다.

#### 결과

DevOps가 등장하면서 개발 주기가 짧아졌는데, 개발 주기가 짧아짐에 따라 배포가 더 자주 이루어지지만 마이크로서비스 아키텍처가 유행하면서 프로그램은 더 세분화되어 쪼개졌기 때문에 관리는 몇 배로 복잡해졌다. 거기에 새로운 툴들의 등장과 클라우드 서비스의 발전으로 설치해야 할 서버가 수백 대를 넘어가는 상황이 되었다. 이러한 상황에서 등장한 것이 도커이다.

### 도커의 등장

도커는 2013년 3월에 처음 공개되었는데, 발표에서 리눅스 컨테이너를 매우 쉽고 빠르게 생성할 수 있다는 점 등으로 인기를 얻기 시작하면서 아예 회사 이름까지 도커(Docker Inc.)로 바꿔버리고 2014년에는 도커에 집중하기 위해 회사의 기존 플랫폼까지 매각하면서 엄청난 액수의 투자를 유치하는 등 빠르게 성장해 나갔다. 공개 당시에는 도커의 개념도 모르는 사람들이 굉장히 많았지만, 지금은 개발자라면 이름이라도 한 번쯤 들어 봤을 정도로 널리 쓰이는 프로그램이 되었다.

## 도커의 구조

도커는 기본적으로 리눅스 컨테이너에서부터 시작된 기술이라고 할 수 있다. 리눅스에는 LXC(LinuX Containers)라고 하는 기능이 내장되어 있는데, 이는 단일 컴퓨팅 시스템에 설치된 리눅스 OS 상에서 다른 영역과 **완전히 분리된 별도의 리눅스 시스템을 운영할 수 있는 커널 기술**을 의미한다. 따라서 운영체제 레벨에서 영역과 자원 할당(CPU, 메모리 등)을 분리하여 별도의 시스템처럼 사용할 수 있게 되는 것인데, 도커는 LXC 기술을 사용하여 리눅스 컨테이너를 만들고 이 컨테이너 상에 별도로 구성된 파일 시스템에 시스템 설정 및 응용 프로그램을 실행할 수 있도록 하는 기술을 정의한 것이라고 이해하면 된다.

> 초기 Docker는 LXC 기술을 기반으로 구현하였지만, 최근에는 별도의 컨테이너 기술을 구현하여 사용하고 있다고 한다.

### 도커의 주요 구성 요소

#### Docker Engine

- 도커는 서버/클라이언트 구조로 이루어짐
- 도커 서버는 데몬 프로세스(daemon process) 형태로 동작
  - 데몬(daemon)이란 사용자가 직접적으로 제어하지 않고, 백그라운드에서 실행되며 여러 작업을 수행하는 프로그램을 의미
- 도커 데몬 프로세스에 요청하기 위해 REST API를 사용함
- 도커 커맨드(command)는 일종의 클라이언트로 이해할 수 있음
  - 도커 명령을 내리면 내부적으로 REST API를 사용하여 도커 데몬 프로세스를 호출함

#### Docker Image

- 도커 컨테이너를 생성하기 위한 명령들을 가진 템플릿
- 여러 이미지들을 레이어로 쌓아서 원하는 이미지를 만드는 것이 일반적
  - 예: 우분투 이미지에 아파치 이미지를 얹어 웹서버 이미지를 만듬

#### Docker Container

- 도커 이미지가 리눅스 컨테이너의 형태로 실행한 상태(인스턴스)를 의미함
- 도커 데몬에 있는 커널에서 LXC로 리눅스 컨테이너를 생성한 후, 해당 컨테이너에 도커 이미지에 포함된 명령을 실행하여 컨테이너를 만들고 실행함
- 도커 컨테이너는 분리된 공간이므로 도커 데몬 프로세스를 통해 접속할 수도 있으며, 내부에 접속에 코드 수정, 재실행 등도 가능함
